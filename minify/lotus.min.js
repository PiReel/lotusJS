var Lotus=function(){};Lotus.Context=function(config,params){this.config=config;this.eventDispatcher=Lotus.EventDispatcherFactory.getInstance().getEventDispatcher(config,params);this.componentMap=new Lotus.ComponentMap(this);this.commandMap=new Lotus.CommandMap(this);this.injector=new Lotus.Injector(this);this.mediatorMap=new Lotus.MediatorMap(this);this.startUp()};Lotus.Context.prototype.startUp=function(){this.mapObjects();this.mapComponents();this.mapCommands();this.mapMediators()};Lotus.Context.prototype.mapComponents=function(){};Lotus.Context.prototype.mapCommands=function(){};Lotus.Context.prototype.mapObjects=function(){};Lotus.Context.prototype.mapMediators=function(){};Lotus.CommandMap=function(context){this.eventFunctionMap={};this.instanceMap={};this.context=context};Lotus.CommandMap.prototype.addCommand=function(eventType,handler,functionName,useSingleton){if(useSingleton===null||useSingleton===undefined){useSingleton=false}if(functionName===null||functionName===undefined){functionName="execute"}if(this.eventFunctionMap[eventType]===null||this.eventFunctionMap[eventType]===undefined){this.eventFunctionMap[eventType]=[]}if(this.hasCommandMap(eventType,handler,functionName)){return}this.eventFunctionMap[eventType].push({eventType:eventType,handler:handler,functionName:functionName,useSingleton:useSingleton});if(useSingleton){if(this.instanceMap[eventType]===null||this.instanceMap[eventType]===undefined){this.instanceMap[eventType]={}}if(this.instanceMap[eventType][handler]===null||this.instanceMap[eventType][handler]===undefined){this.instanceMap[eventType][handler]=new handler(this.context)}}if(!this.context.eventDispatcher.canListen(eventType,this,"routeEventToCommand")){this.context.eventDispatcher.addEventListener(eventType,this,"routeEventToCommand")}};Lotus.CommandMap.prototype.hasCommandMap=function(eventType,handler,functionName){var hasCommand=false;if(this.eventFunctionMap[eventType]!==null&&this.eventFunctionMap[eventType]!==undefined){var mapArray=this.eventFunctionMap[eventType];for(var itemIndex=0;itemIndex<mapArray.length;itemIndex++){var item=mapArray[itemIndex];if(item.handler==handler&&item.functionName==functionName){hasCommand=true;break}}}return hasCommand};Lotus.CommandMap.prototype.removeCommand=function(eventType,handler){if(this.eventFunctionMap[eventType]!==null&&this.eventFunctionMap[eventType]!==undefined){var mapArray=this.eventFunctionMap[eventType];for(var itemIndex=mapArray.length-1;itemIndex>=0;itemIndex--){var item=mapArray[itemIndex];if(item.handler==handler){switch(itemIndex){case 0:mapArray.shift();break;case mapArray.length-1:mapArray.pop();break;default:var head=mapArray.slice(0,itemIndex);var tail=mapArray.slice(itemIndex+1);mapArray=head.concat(tail);break}}}if(this.eventFunctionMap[eventType].length<=0){this.context.eventDispatcher.removeEventListener(eventType,this,"routeEventToCommand");delete this.eventFunctionMap[eventType]}}};Lotus.CommandMap.prototype.removeAllCommands=function(){this.eventFunctionMap={};this.instanceMap={};this.context.eventDispatcher.removeAllEventListeners(this)};Lotus.CommandMap.prototype.routeEventToCommand=function(event){if(this.eventFunctionMap[event.type]!==null&&this.eventFunctionMap[event.type]!==undefined){var mapArray=this.eventFunctionMap[event.type];for(var itemIndex=0;itemIndex<mapArray.length;itemIndex++){var item=mapArray[itemIndex];if(item.useSingleton){this.instanceMap[item.event.type][item.handler][item.functionName]()}else{var instance;if(typeof item.handler==="object"){instance=item.handler}else{instance=new item.handler(this.context)}instance[item.functionName](event)}}}};Lotus.ComponentList=function(){this.instancesByConstructor={};Lavender.ArrayList.prototype.constructor.call(this)};Lavender.ObjectUtils.extend(Lavender.ArrayList,Lotus.ComponentList);Lotus.ComponentList.prototype.addToHash=function(object){if(this.instancesByConstructor[object.constructor]===null||this.instancesByConstructor[object.constructor]===undefined){this.instancesByConstructor[object.constructor]=[]}this.instancesByConstructor[object.constructor].push(object)};Lotus.ComponentList.prototype.removeItemFromHash=function(hash,object){var objects=hash[object.constructor];if(objects===null||objects===undefined||objects.length<1){return}for(var i=0;i<objects.length;i++){if(objects[i]==object){switch(i){case 0:objects.shift();break;case objects.length-1:objects.pop();break;default:var head=objects.slice(0,i);var tail=objects.slice(i+1);hash[object.constructor]=head.concat(tail);break}break}}};Lotus.ComponentList.prototype.addItem=function(object){var index=Lavender.ArrayList.prototype.addItem.call(this,object);this.addToHash(object);return index};Lotus.ComponentList.prototype.clear=function(){Lavender.ArrayList.prototype.clearHash.call(this,this.instancesByConstructor);Lavender.ArrayList.prototype.clear.call(this)};Lotus.ComponentList.prototype.removeItemAt=function(index){var object=this.getItemAt(index);this.removeItemFromHash.call(this,this.instancesByConstructor,object);Lavender.ArrayList.prototype.removeItemAt.call(this,index)};Lotus.ComponentList.prototype.insert=function(object,index){Lavender.ArrayList.prototype.insert.call(this,object,index);this.addToHash(object)};Lotus.ComponentMap=function(context){this.context=context;this.componentInstances=new Lotus.ComponentList;this.tagInstanceToRequestId={}};Lotus.ComponentMap.prototype.success=function(result){var tagInstance=this.tagInstanceToRequestId[result.requestId];var div=document.createElement("div");div.innerHTML=result.resultObj;var clone=document.importNode(div.childNodes[0].content,true);var component=clone.querySelector(tagInstance.getAttribute("component-root"));component.lotusComponentInstance=tagInstance.lotusComponentInstance;var host=tagInstance.createShadowRoot();host.appendChild(clone);this.createComponent(component);if(window.WebComponents&&window.WebComponents.ShadowCSS){window.WebComponents.ShadowCSS.shimStyling(host,tagInstance.nodeName)}};Lotus.ComponentMap.prototype.fault=function(fault){console.log(fault);throw new Error("Could not load template. Please check you defined the correct path.")};Lotus.ComponentMap.prototype.addComponent=function(tagInstance,functionConstructor){if(tagInstance.lotusComponentInstance===null||tagInstance.lotusComponentInstance===undefined){tagInstance.lotusComponentInstance=new functionConstructor;this.componentInstances.addItem(tagInstance.lotusComponentInstance)}this.context.mediatorMap.apply(tagInstance.tagName.toLowerCase(),tagInstance.lotusComponentInstance);var src=tagInstance.getAttribute("template-url");if(src!==null&&src!==undefined){var httpService=new Lavender.XhrHttpService;httpService.addResponder(this);httpService.send("GET",src,null,"text/html","html",true);this.tagInstanceToRequestId[httpService.requestId]=tagInstance;return}this.createComponent(tagInstance)};Lotus.ComponentMap.prototype.createComponent=function(tagInstance){tagInstance.lotusComponentInstance.created(tagInstance,this.context)};Lotus.ComponentMap.prototype.mapComponent=function(tagName,prototype,functionConstructor,framework){if(framework===null||framework===undefined){framework=xtag}var componentMap=this;framework.register(tagName,{prototype:prototype,lifecycle:{created:function(){componentMap.addComponent(this,functionConstructor)},inserted:function(){this.lotusComponentInstance.inserted(this)},removed:function(){this.lotusComponentInstance.removed(this)},attributeChanged:function(){this.lotusComponentInstance.attributeChanged(this)}}})};Lotus.MediatorMap=function(context){this.tagConstructorMap={};this.mediatorInstanceMap=[];this.context=context};Lotus.MediatorMap.prototype.add=function(tagName,mediatorConstructor,useSingleton){if(useSingleton===null||useSingleton===undefined){useSingleton=false}if(this.hasMediatorMap(tagName,mediatorConstructor)){return}this.tagConstructorMap[tagName]={useSingleton:useSingleton,constructor:mediatorConstructor,id:Lavender.UuidUtils.generateUUID(),name:mediatorConstructor.toString()}};Lotus.MediatorMap.prototype.remove=function(tagName,mediatorConstructor){if(!this.hasMediatorMap(tagName,mediatorConstructor)){return}var mapId=this.tagConstructorMap[tagName].id;this.tagConstructorMap[tagName]=null;delete this.tagConstructorMap[tagName];if(this.mediatorInstanceMap[mapId]===null||this.mediatorInstanceMap[mapId]===undefined){return}for(var i=0;i<this.mediatorInstanceMap[mapId].length;i++){this.mediatorInstanceMap[mapId][i].destroy()}this.mediatorInstanceMap[mapId]=null;delete this.mediatorInstanceMap[mapId];return mapId};Lotus.MediatorMap.prototype.apply=function(tagName,componentInstance){var map=this.tagConstructorMap[tagName];if(!map){return}if(this.mediatorInstanceMap[map.id]===null||this.mediatorInstanceMap[map.id]===undefined){this.mediatorInstanceMap[map.id]=[]}if(map.useSingleton){if(this.mediatorInstanceMap[map.id].length==0){this.mediatorInstanceMap[map.id].push(new map.constructor(componentInstance,this.context))}}else{this.mediatorInstanceMap[map.id].push(new map.constructor(componentInstance,this.context))}};Lotus.MediatorMap.prototype.hasMediatorMap=function(tagName,mediatorConstructor){return this.tagConstructorMap.hasOwnProperty(tagName)&&this.tagConstructorMap[tagName].name==mediatorConstructor.toString()};Lotus.Injector=function(context){this.context=context;this.objectMap={}};Lotus.Injector.prototype.mapObject=function(key,constructor,useSingleton){if(key===null||key===undefined||key.length<=0||typeof key!=="string"){throw new Error("Lotus.Injector.prototype.mapObject: key must be a string with a length greater than 0")}if(constructor===null||constructor===undefined||typeof constructor!=="function"){throw new Error("Lotus.Injector.prototype.mapObject: constructor must be a function")}if(useSingleton===null||useSingleton===undefined){useSingleton=false}this.objectMap[key]={constructor:constructor,useSingleton:useSingleton,instance:null}};Lotus.Injector.prototype.mapSingletonInstance=function(key,instance){if(key===null||key===undefined||key.length<=0||typeof key!=="string"){throw new Error("Lotus.Injector.prototype.mapSingletonInstance: key must be a string with a length greater than 0")}if(instance===null||instance===undefined){throw new Error("Lotus.Injector.prototype.mapSingletonInstance: instance must be defined")}this.objectMap[key]={constructor:null,useSingleton:true,instance:instance}};Lotus.Injector.prototype.inject=function(key){if(this.objectMap[key]!==null&&this.objectMap[key]!==undefined){if(this.objectMap[key].useSingleton){if(this.objectMap[key].instance===null){this.objectMap[key].instance=new this.objectMap[key].constructor}return this.objectMap[key].instance}else{return new this.objectMap[key].constructor}}throw new Error("Lotus.Injector.prototype.getObject: could not find object for key: "+key)};Lotus.ItemViewEvent=function(eventType,payload){if(eventType==Lotus.ItemViewEvent.ITEM_SELECTED&&(payload.item===null||payload.item===undefined)){throw new Error("Lotus.ItemViewEvent payload.item is required")}Lavender.AbstractEvent.prototype.constructor.call(this,eventType,payload)};Lavender.ObjectUtils.extend(Lavender.AbstractEvent,Lotus.ItemViewEvent);Lotus.ItemViewEvent.prototype.clone=function(){return new Lotus.ItemViewEvent(this.type,this.payload)};Lotus.ItemViewEvent.ITEM_SELECTED="itemViewItemSelected";Lotus.ItemViewEvent.ITEM_DESELECTED="itemViewItemDeselected";Lotus.ItemViewEvent.REMOVE_ITEM="itemViewRemoveItem";Lotus.ComponentEvent=function(eventType,payload){Lavender.AbstractEvent.prototype.constructor.call(this,eventType,payload)};Lavender.ObjectUtils.extend(Lavender.AbstractEvent,Lotus.ComponentEvent);Lotus.ComponentEvent.prototype.clone=function(){return new Lotus.ComponentEvent(this.type,this.payload)};Lotus.ComponentEvent.READY="lotusComponentReady";Lotus.AbstractCommand=function(context){this.action=null;this.context=context;Lavender.AbstractEventDispatcher.prototype.constructor.call(this)};Lavender.ObjectUtils.extend(Lavender.AbstractEventDispatcher,Lotus.AbstractCommand);Lotus.AbstractCommand.prototype.execute=function(event){this.action=this.getAction(event);this.action.addEventListener(Lavender.ActionSuccessEvent.SUCCESS,this,"onSuccess");this.action.addEventListener(Lavender.ActionErrorEvent.ERROR,this,"onError");this.action.execute()};Lotus.AbstractCommand.prototype.getAction=function(event){return null};Lotus.AbstractCommand.prototype.onSuccess=function(event){};Lotus.AbstractCommand.prototype.onError=function(event){this.destroy();if(console!==null&&console!==undefined){console.log("Lotus.AbstractCommand.prototype.onError: "+event.payload.message)}};Lotus.AbstractCommand.prototype.destroy=function(){if(this.canListen(Lavender.ActionErrorEvent.ERROR,this,"onError")){this.removeEventListener(Lavender.ActionErrorEvent.ERROR,this,"onError")}if(this.canListen(Lavender.ActionSuccessEvent.SUCCESS,this,"onSuccess")){this.removeEventListener(Lavender.ActionSuccessEvent.SUCCESS,this,"onSuccess")}this.action=null;this.context=null};Lotus.EventDispatcherFactory=function(){if(Lotus.EventDispatcherFactory.instance!=null){throw"Lotus.EventDispatcherFactory.instance: Singleton class has already been instantiated"}else{}};Lotus.EventDispatcherFactory.getInstance=function(){if(Lotus.EventDispatcherFactory.instance==null){Lotus.EventDispatcherFactory.instance=new Lotus.EventDispatcherFactory}return Lotus.EventDispatcherFactory.instance};Lotus.EventDispatcherFactory.instance=null;Lotus.EventDispatcherFactory.prototype.getEventDispatcher=function(config,params){var dispatcher;switch(config.eventDispatcherCode){case"jquery":dispatcher=new Lavender.JqueryEventDispatcher;break;case"angular":dispatcher=new Lavender.AngularEventDispatcher(params);break;case"abstract":default:dispatcher=new Lavender.AbstractEventDispatcher}return dispatcher};Lotus.HttpServiceFactory=function(){if(Lotus.HttpServiceFactory.instance!=null){throw"Lotus.HttpServiceFactory.instance: Singleton class has already been instantiated"}else{}};Lotus.HttpServiceFactory.getInstance=function(){if(Lotus.HttpServiceFactory.instance==null){Lotus.HttpServiceFactory.instance=new Lotus.HttpServiceFactory}return Lotus.HttpServiceFactory.instance};Lotus.HttpServiceFactory.instance=null;Lotus.HttpServiceFactory.prototype.getHttpService=function(config){var httpService;switch(config.httpServiceCode){case"angular":httpService=new Lavender.AngularHttpService;break;case"jquery":httpService=new Lavender.JqueryHttpService;break;default:httpService=new Lavender.XhrHttpService;break}return httpService};Lotus.SerializeFactory=function(){if(Lotus.SerializeFactory.instance!=null){throw"Lotus.SerializeFactory.instance: Singleton class has already been instantiated"}else{}};Lotus.SerializeFactory.prototype.getServiceResultParser=function(config){var parser;switch(config.parserCode){case"local":case"remote":default:parser={};break}return parser};Lotus.SerializeFactory.prototype.getServiceExporter=function(config){var exporter;switch(config.exporterCode){case"local":case"remote":default:exporter={};break}return exporter};Lotus.SerializeFactory.getInstance=function(){if(Lotus.SerializeFactory.instance==null){Lotus.SerializeFactory.instance=new Lotus.SerializeFactory}return Lotus.SerializeFactory.instance};Lotus.SerializeFactory.instance=null;Lotus.ServiceFactory=function(){if(Lotus.ServiceFactory.instance!=null){throw"Lotus.ServiceFactory.instance: Singleton class has already been instantiated"}else{}};Lotus.ServiceFactory.getInstance=function(){if(Lotus.ServiceFactory.instance==null){Lotus.ServiceFactory.instance=new Lotus.ServiceFactory}return Lotus.ServiceFactory.instance};Lotus.ServiceFactory.instance=null;Lotus.ServiceFactory.prototype.getService=function(config){var dao;switch(config.serviceCode){case"1.0":case"1.1":case"2.50.4878.21250":default:dao=new Lotus.SampleService(config)}return dao};Lotus.AbstractMediator=function(componentInstance,context){var _id=Lavender.UuidUtils.generateUUID();var _componentInstance=componentInstance;var _context=context;this.addProperties({id:{get:function(){return _id},set:function(val){_id=val;this.Notify(val,"id")}},context:{get:function(){return _context},set:function(val){_context=val;this.Notify(val,"context")}},componentInstance:{get:function(){return _componentInstance},set:function(val){_componentInstance=val;this.Notify(val,"componentInstance")}}});Lavender.Subject.prototype.constructor.call(this);if(!this.componentInstance.ready){this.componentInstance.addEventListener(Lotus.ComponentEvent.READY,this,"init")}else{this.init()}};Lavender.ObjectUtils.extend(Lavender.Subject,Lotus.AbstractMediator);Lotus.AbstractMediator.toString=function(){return"Lotus.AbstractMediator"};Lotus.AbstractMediator.prototype.init=function(event){this.addEventListeners();this.setUpBindings()};Lotus.AbstractMediator.prototype.addEventListeners=function(){};Lotus.AbstractMediator.prototype.setUpBindings=function(){};Lotus.AbstractMediator.prototype.removeEventListeners=function(){if(this.componentInstance.canListen(Lotus.ComponentEvent.READY,this,"init")){this.componentInstance.removeEventListener(Lotus.ComponentEvent.READY,this,"init")}};Lotus.AbstractMediator.prototype.removeBindings=function(){this.binder.unbindAll()};Lotus.AbstractMediator.prototype.toString=function(){return this.id};Lotus.AbstractMediator.prototype.destroy=function(){this.removeEventListeners();this.removeBindings();this.id=null;this.componentInstance=null};Lotus.ButtonMediator=function(componentInstance,context){Lotus.AbstractMediator.prototype.constructor.call(this,componentInstance,context)};Lavender.ObjectUtils.extend(Lotus.AbstractMediator,Lotus.ButtonMediator);Lotus.ButtonMediator.toString=function(){return"Lotus.ButtonMediator"};Lotus.ButtonMediator.prototype.addEventListeners=function(){this.componentInstance.addEventListener("click",this,"onClick")};Lotus.ButtonMediator.prototype.onClick=function(event){console.log("Im the button mediator, I can handle the component click and dispatch an application event")};Lotus.ButtonMediator.prototype.removeEventListeners=function(){this.componentInstance.removeEventListener("click",this,"onClick")};Lotus.ListMediator=function(componentInstance,context){Lotus.AbstractMediator.prototype.constructor.call(this,componentInstance,context)};Lavender.ObjectUtils.extend(Lotus.AbstractMediator,Lotus.ListMediator);Lotus.ListMediator.toString=function(){return"Lotus.ListMediator"};Lotus.SkinPart=function(label,instance,attribute){if(label===null||label===undefined){throw new Error("Lotus.SkinPart.prototype.constructor: label is required")}var _label=label;var _attribute=attribute;var _instance=instance;this.addProperties({label:{get:function(){return _label}},element:{get:function(){return _instance[_attribute]},set:function(val){_instance[_attribute]=val;this.Notify(val,"element")}}});Lavender.Subject.prototype.constructor.call(this)};Lavender.ObjectUtils.extend(Lavender.Subject,Lotus.SkinPart);Lotus.SkinPartList=function(){this.skinPartsByLabel={};Lavender.ArrayList.prototype.constructor.call(this)};Lavender.ObjectUtils.extend(Lavender.ArrayList,Lotus.SkinPartList);Lotus.SkinPartList.prototype.validateItem=function(object){if(object instanceof Lotus.SkinPart===false){throw Error("Lotus.SkinPartList.prototype.addItem: object must be of type Lotus.SkinPart")}};Lotus.SkinPartList.prototype.addItem=function(object){var index=Lavender.ArrayList.prototype.addItem.call(this,object);this.skinPartsByLabel[object.label]=object;return index};Lotus.SkinPartList.prototype.clear=function(){Lavender.ArrayList.prototype.clearHash.call(this,this.skinPartsByLabel);Lavender.ArrayList.prototype.clear.call(this)};Lotus.SkinPartList.prototype.removeItemAt=function(index){var skinPart=this.getItemAt(index);Lavender.ArrayList.prototype.removeItemFromHash.call(this,this.skinPartsByLabel,skinPart.label);Lavender.ArrayList.prototype.removeItemAt.call(this,index)};Lotus.SkinPartList.prototype.insert=function(object,index){Lavender.ArrayList.prototype.insert.call(this,object,index);this.skinPartsByLabel[object.label]=object};Lotus.AbstractComponent=function(){var _element;var _context;var _ready=false;var _id=Math.random();var _skinParts=new Lotus.SkinPartList;Lavender.Subject.prototype.constructor.call(this);this.addProperties({element:{get:function(){return _element},set:function(val){_element=val;if(_element!==null&&_element!==undefined){_element.getComponentInstance=this.getComponentInstance.bind(this)}this.Notify(val,"element")}},context:{get:function(){return _context},set:function(val){_context=val;this.Notify(val,"context")}},id:{get:function(){return _id},set:function(val){_id=val;this.Notify(val,"id")}},skinParts:{get:function(){return _skinParts},set:function(val){_skinParts=val;this.Notify(val,"skinParts")}},ready:{get:function(){return _ready},set:function(val){_ready=val;this.Notify(val,"ready")}}});Lavender.ObjectUtils.mixin(Lavender.AbstractEventDispatcher,Lotus.AbstractComponent,this);console.log("Lotus.AbstractComponent.prototype.constructor")};Lavender.ObjectUtils.extend(Lavender.Subject,Lotus.AbstractComponent);Lotus.AbstractComponent.prototype.init=function(){this.addAttributes();this.defineSkinParts();this.addSkinParts()};Lotus.AbstractComponent.prototype.getComponentInstance=function(){return this};Lotus.AbstractComponent.prototype.addAttributes=function(){for(var i=0;i<this.element.attributes.length;i++){var attribute=this.element.attributes[i];if(attribute.name.indexOf("attribute-")>=0){var index=attribute.name.indexOf("attribute-")+10;var newProp=attribute.name.substring(index);var camelCased=newProp.replace(/-([a-z])/g,function(g){return g[1].toUpperCase()});if(this.hasOwnProperty(camelCased)){this[camelCased]=attribute.value}}}};Lotus.AbstractComponent.prototype.addSkinParts=function(){if(this.element.getAttribute("skin-part")!==null&&this.element.getAttribute("skin-part")!==undefined){this.addSkinPart(this.element.getAttribute("skin-part"),this.element)}var skinPartsNodeList=this.element.querySelectorAll("[skin-part]");for(var i=0;i<skinPartsNodeList.length;i++){this.addSkinPart(skinPartsNodeList[i].getAttribute("skin-part"),skinPartsNodeList[i])}};Lotus.AbstractComponent.prototype.onReady=function(){this.ready=true;this.dispatch(new Lotus.ComponentEvent(Lotus.ComponentEvent.READY))};Lotus.AbstractComponent.prototype.created=function(element,context){console.log("Lotus.AbstractComponent.prototype.created");this.element=element;this.context=context;this.init();this.onReady()};Lotus.AbstractComponent.prototype.inserted=function(element){console.log("Lotus.AbstractComponent.prototype.inserted")};Lotus.AbstractComponent.prototype.removed=function(element){console.log("Lotus.AbstractComponent.prototype.removed");this.destroy()};Lotus.AbstractComponent.prototype.attributeChanged=function(element){console.log("Lotus.AbstractComponent.prototype.attributeChanged")};Lotus.AbstractComponent.prototype.addSkinPart=function(part,element){if(this.skinParts.skinPartsByLabel[part]===null||this.skinParts.skinPartsByLabel[part]===undefined){return null}this.skinParts.skinPartsByLabel[part].element=element;this.onSkinPartAdded(part,this.skinParts.skinPartsByLabel[part].element)};Lotus.AbstractComponent.prototype.onSkinPartAdded=function(part,element){};Lotus.AbstractComponent.prototype.defineSkinParts=function(){};Lotus.AbstractComponent.prototype.addEventListeners=function(){};Lotus.AbstractComponent.prototype.removeEventListeners=function(){};Lotus.AbstractComponent.prototype.destroy=function(){this.removeEventListeners();this.binder.unbindAll();this.binder=null;this.observer=null;this.element=null;this.context=null;this.id=null};Lotus.AbstractCollectionView=function(){var _collectionContainer;var _itemTemplate;var _selectedItem;var _collection;var _itemView;var _childViews=new Lavender.ArrayList;Lotus.AbstractComponent.prototype.constructor.call(this);this.addProperties({collectionContainer:{get:function(){return _collectionContainer},set:function(val){_collectionContainer=val;this.Notify(val,"collectionContainer")}},itemTemplate:{get:function(){return _itemTemplate},set:function(val){_itemTemplate=val;this.Notify(val,"itemTemplate")}},selectedItem:{get:function(){return _selectedItem},set:function(val){_selectedItem=val;this.Notify(val,"selectedItem")}},collection:{get:function(){return _collection},set:function(val){this.removeCollectionEventListeners();_collection=val;this.addCollectionEventListeners();this.Notify(val,"collection")}},itemView:{get:function(){return _itemView},set:function(val){_itemView=val;this.Notify(val,"itemView")}},childViews:{get:function(){return _childViews}}});this.destoryChildViews=function(){for(var i=0;i<_childViews.length;i++){this.removeChildView(_childViews[i])}_childViews=null}};Lavender.ObjectUtils.extend(Lotus.AbstractComponent,Lotus.AbstractCollectionView);Lotus.AbstractCollectionView.prototype.init=function(){Lotus.AbstractComponent.prototype.init.call(this);if(this.collection===null||this.collection===undefined){this.collection=this.getCollection()}this.render()};Lotus.AbstractCollectionView.prototype.addCollectionEventListeners=function(){if(this.collection!==null&&this.collection!==undefined){this.collection.addEventListener(Lavender.CollectionEvent.COLLECTION_CHANGE,this,"onCollectionChange")}};Lotus.AbstractCollectionView.prototype.removeCollectionEventListeners=function(){if(this.collection!==null&&this.collection!==undefined){this.collection.removeEventListener(Lavender.CollectionEvent.COLLECTION_CHANGE,this,"onCollectionChange")}};Lotus.AbstractCollectionView.prototype.render=function(){if(this.itemView===null||this.itemView==undefined){throw Error("data-attribute-item-view must be defined on the tag instance and point to a valid constructor")}for(var i=0;i<this.collection.length;i++){this.addChildView(this.collection.getItemAt(i))}};Lotus.AbstractCollectionView.prototype.defineSkinParts=function(){Lotus.AbstractComponent.prototype.defineSkinParts.call(this);this.skinParts.addItem(new Lotus.SkinPart("collectionContainer",this,"collectionContainer"));this.skinParts.addItem(new Lotus.SkinPart("itemTemplate",this,"itemTemplate"))};Lotus.AbstractCollectionView.prototype.onSkinPartAdded=function(part,element){Lotus.AbstractComponent.prototype.onSkinPartAdded.call(this,part,element);switch(part){case"itemTemplate":element.parentNode.removeChild(element);break}};Lotus.AbstractCollectionView.prototype.getCollection=function(event){return new Lavender.ArrayList};Lotus.AbstractCollectionView.prototype.onCollectionChange=function(event){switch(event.payload.type){case"add":this.addChildView(event.payload.item);break;case"remove":this.removeChildViewFromModel(event.payload.item);break;case"removeAll":this.removeAllChildViews();break}};Lotus.AbstractCollectionView.prototype.createChildView=function(model){var evalClass=eval(this.itemView);return new evalClass};Lotus.AbstractCollectionView.prototype.addChildView=function(model){var view=this.createChildView(model);var clone=this.itemTemplate.cloneNode(true);view.model=model;view.element=clone;view.init();this.childViews.addItem(view);if(this.collectionContainer!==null&&this.collectionContainer!==undefined){this.collectionContainer.appendChild(view.element)}else{this.element.appendChild(view.element)}this.addViewEventListeners(view)};Lotus.AbstractCollectionView.prototype.addViewEventListeners=function(view){view.addEventListener(Lotus.ItemViewEvent.ITEM_SELECTED,this,"onItemSelectedDeselect");view.addEventListener(Lotus.ItemViewEvent.ITEM_DESELECTED,this,"onItemSelectedDeselect");view.addEventListener(Lotus.ItemViewEvent.REMOVE_ITEM,this,"onItemRemove")};Lotus.AbstractCollectionView.prototype.removeViewEventListeners=function(view){view.removeEventListener(Lotus.ItemViewEvent.ITEM_SELECTED,this,"onItemSelectedDeselect");view.removeEventListener(Lotus.ItemViewEvent.ITEM_DESELECTED,this,"onItemSelectedDeselect");view.removeEventListener(Lotus.ItemViewEvent.REMOVE_ITEM,this,"onItemRemove")};Lotus.AbstractCollectionView.prototype.onItemSelectedDeselect=function(event){if(this.selectedItem!==null&&this.selectedItem!==undefined&&this.selectedItem!=event.payload.item){this.selectedItem.resetState()}this.selectedItem=event.type==Lotus.ItemViewEvent.ITEM_SELECTED?event.payload.item:null};Lotus.AbstractCollectionView.prototype.onItemRemove=function(event){var index=this.collection.indexOf(event.payload.item.model);if(index>=0){this.collection.removeItemAt(index)}};Lotus.AbstractCollectionView.prototype.addAllChildViews=function(models){for(var i=0;i<models.length;i++){this.addChildView(models[i])}};Lotus.AbstractCollectionView.prototype.removeAllChildViews=function(){for(var i=this.childViews.length()-1;i>=0;i--){this.removeChildView(this.childViews.getItemAt(i))}};Lotus.AbstractCollectionView.prototype.removeChildView=function(view){this.removeViewEventListeners(view);this.removeElement(view.element);view.destroy();this.childViews.removeItemAt(this.childViews.indexOf(view))};Lotus.AbstractCollectionView.prototype.removeElement=function(element){if(this.collectionContainer!==null&&this.collectionContainer!==undefined){this.collectionContainer.removeChild(element)}else{this.element.removeChild(element)}};Lotus.AbstractCollectionView.prototype.removeChildViewFromModel=function(model){for(var i=0;i<this.childViews.length();i++){if(this.childViews.getItemAt(i).model==model){this.removeChildView(this.childViews.getItemAt(i));break}}};Lotus.AbstractCollectionView.prototype.destroy=function(){Lotus.AbstractComponent.prototype.destroy.call(this);if(this.collectionContainer!==null&&this.collectionContainer!==undefined){while(this.collectionContainer.firstChild){this.collectionContainer.removeChild(this.collectionContainer.firstChild)}}else{while(this.element.firstChild){this.element.removeChild(this.firstChild)}}this.destoryChildViews();this.collection=null;this.itemView=null;this.collectionContainer=null;this.itemTemplate=null;this.selectedItem=null};Lotus.AbstractRecordSetCollectionView=function(){var _navBtnEnabledClass;var _navBtnDisabledClass;var _nextBtn;var _pervBtn;var _firstBtn;var _lastBtn;Lotus.AbstractCollectionView.prototype.constructor.call(this);this.addProperties({nextBtn:{get:function(){return _nextBtn},set:function(val){_nextBtn=val;this.Notify(val,"nextBtn")}},pervBtn:{get:function(){return _pervBtn},set:function(val){_pervBtn=val;this.Notify(val,"pervBtn")}},firstBtn:{get:function(){return _firstBtn},set:function(val){_firstBtn=val;this.Notify(val,"firstBtn")}},lastBtn:{get:function(){return _lastBtn},set:function(val){_lastBtn=val;this.Notify(val,"lastBtn")}},navBtnEnabledClass:{get:function(){return _navBtnEnabledClass},set:function(val){_navBtnEnabledClass=val;this.Notify(val,"navBtnEnabledClass")}},navBtnDisabledClass:{get:function(){return _navBtnDisabledClass},set:function(val){_navBtnDisabledClass=val;this.Notify(val,"navBtnDisabledClass")}}});this.nextBtn=null;this.pervBtn=null;this.firstBtn=null;this.lastBtn=null;this.onNavBtnClickProxy=this.onClickHandler.bind(this)};Lavender.ObjectUtils.extend(Lotus.AbstractCollectionView,Lotus.AbstractRecordSetCollectionView);Lotus.AbstractRecordSetCollectionView.prototype.addCollectionEventListeners=function(){if(this.collection!==null&&this.collection!==undefined){this.collection.addEventListener(Lavender.RecordSetEvent.RESULTS_CHANGE,this,"onResultsChange");this.binder.bind(this.collection,"pageList",this,"onPageListChange",null,null,"pageListChaneHandler")}};Lotus.AbstractRecordSetCollectionView.prototype.removeCollectionEventListeners=function(){if(this.collection!==null&&this.collection!==undefined){this.collection.removeEventListener(Lavender.RecordSetEvent.RESULTS_CHANGE,this,"onResultsChange")}if(this.binder!==null&&this.binder!==undefined){this.binder.unbind("pageListChaneHandler")}};Lotus.AbstractRecordSetCollectionView.prototype.defineSkinParts=function(){Lotus.AbstractCollectionView.prototype.defineSkinParts.call(this);this.skinParts.addItem(new Lotus.SkinPart("nextBtn",this,"nextBtn"));
this.skinParts.addItem(new Lotus.SkinPart("pervBtn",this,"pervBtn"));this.skinParts.addItem(new Lotus.SkinPart("firstBtn",this,"firstBtn"));this.skinParts.addItem(new Lotus.SkinPart("lastBtn",this,"lastBtn"))};Lotus.AbstractRecordSetCollectionView.prototype.onSkinPartAdded=function(part,element){Lotus.AbstractCollectionView.prototype.onSkinPartAdded.call(this,part,element);switch(part){case"nextBtn":this.nextBtn.addEventListener("click",this.onNavBtnClickProxy);break;case"pervBtn":this.pervBtn.addEventListener("click",this.onNavBtnClickProxy);break;case"firstBtn":this.firstBtn.addEventListener("click",this.onNavBtnClickProxy);break;case"lastBtn":this.lastBtn.addEventListener("click",this.onNavBtnClickProxy);break}if(element.getAttribute("enabled-class")!==null&&element.getAttribute("enabled-class")!==undefined){this.navBtnEnabledClass=element.getAttribute("enabled-class")}if(element.getAttribute("disabled-class")!==null&&element.getAttribute("disabled-class")!==undefined){this.navBtnDisabledClass=element.getAttribute("disabled-class")}};Lotus.AbstractRecordSetCollectionView.prototype.onClickHandler=function(event){switch(event.currentTarget.getAttribute("skin-part")){case"nextBtn":if(this.collection.selectedPage+1>this.collection.totalPages){return}this.collection.selectedPage+=1;break;case"pervBtn":if(this.collection.selectedPage-1<1){return}this.collection.selectedPage-=1;break;case"firstBtn":this.collection.selectedPage=1;break;case"lastBtn":this.collection.selectedPage=this.collection.totalPages;break}};Lotus.AbstractRecordSetCollectionView.prototype.render=function(){if(this.itemView===null||this.itemView==undefined){throw Error("attribute-item-view must be defined on the tag instance and point to a valid constructor")}this.removeAllChildViews();if(this.nextBtn){this.refreshNavButtonDisplay(this.nextBtn,"next")}if(this.pervBtn){this.refreshNavButtonDisplay(this.pervBtn,"prev")}if(this.firstBtn){this.refreshNavButtonDisplay(this.firstBtn,"prev")}if(this.lastBtn){this.refreshNavButtonDisplay(this.lastBtn,"next")}if(this.collection.pageList===null||this.collection.pageList===undefined){return}for(var i=0;i<this.collection.pageList.length();i++){var model=this.collection.pageList.getItemAt(i);this.addChildView(model)}this.selectedItem=null};Lotus.AbstractRecordSetCollectionView.prototype.refreshNavButtonDisplay=function(button,type){if(button.classList.contains(this.navBtnDisabledClass)){button.classList.remove(this.navBtnDisabledClass)}if(button.classList.contains(this.navBtnEnabledClass)){button.classList.remove(this.navBtnEnabledClass)}var classToAdd;if(type==="next"){classToAdd=this.collection.selectedPage+1>this.collection.totalPages?this.navBtnDisabledClass:this.navBtnEnabledClass}else{classToAdd=this.collection.selectedPage-1<1?this.navBtnDisabledClass:this.navBtnEnabledClass}button.classList.add(classToAdd)};Lotus.AbstractRecordSetCollectionView.prototype.onResultsChange=function(event){this.render()};Lotus.AbstractRecordSetCollectionView.prototype.onPageListChange=function(value){this.render()};Lotus.AbstractRecordSetCollectionView.prototype.getCollection=function(event){return new Lavender.RecordSet};Lotus.AbstractItemView=function(){var _model;Lotus.AbstractComponent.prototype.constructor.call(this);this.addProperties({model:{get:function(){return _model},set:function(val){_model=val;this.Notify(val,"model")}}})};Lavender.ObjectUtils.extend(Lotus.AbstractComponent,Lotus.AbstractItemView);Lotus.AbstractItemView.prototype.destroy=function(){Lotus.AbstractComponent.prototype.destroy.call(this);this.model=null};Lotus.AbstractItemView.prototype.setElementDisplay=function(element,display){if(element!==null&&element!==undefined){element.style.display=display}};Lotus.AbstractThumbnailView=function(){var _thumbWidth;var _thumbHeight;var _thumbnail;var _thumbnailContainer;var _allowDrag=true;Lotus.AbstractItemView.prototype.constructor.call(this);this.addProperties({thumbnail:{get:function(){return _thumbnail},set:function(val){_thumbnail=val;this.Notify(val,"thumbnail")}},thumbnailContainer:{get:function(){return _thumbnailContainer},set:function(val){_thumbnailContainer=val;this.Notify(val,"thumbnailContainer")}},thumbWidth:{get:function(){return _thumbWidth},set:function(val){_thumbWidth=val;this.Notify(val,"thumbWidth")}},thumbHeight:{get:function(){return _thumbHeight},set:function(val){_thumbHeight=val;this.Notify(val,"thumbHeight")}},allowDrag:{get:function(){return _allowDrag},set:function(val){_allowDrag=val;this.Notify(val,"allowDrag")}}});this.thumbClickProxy=this.onThumbClick.bind(this);this.onDragStartProxy=this.onDragStart.bind(this)};Lavender.ObjectUtils.extend(Lotus.AbstractItemView,Lotus.AbstractThumbnailView);Lotus.AbstractThumbnailView.prototype.setUpBindings=function(){this.binder.bind(this,"model",this,"onModelChange")};Lotus.AbstractThumbnailView.prototype.sizeImage=function(){if(this.thumbnail===null||this.thumbnail===undefined){return}var defaultSize=this.getDefaultSize();var containerSize=this.getContainerSize();var scale=Lavender.ResizeUtils.getScaleToFit(defaultSize,containerSize);var width=defaultSize.width*scale;var height=defaultSize.height*scale;this.thumbnail.setAttribute("width",width+"px");this.thumbnail.setAttribute("height",height+"px");this.thumbnail.style.maxWidth=containerSize.width+"px";this.thumbnail.style.maxHeight=containerSize.height+"px"};Lotus.AbstractThumbnailView.prototype.addEventListeners=function(){if(this.thumbnail===null||this.thumbnail===undefined){return}this.thumbnail.setAttribute("draggable",this.allowDrag);this.thumbnail.addEventListener("click",this.thumbClickProxy);this.thumbnail.addEventListener("dragstart",this.onDragStartProxy)};Lotus.AbstractThumbnailView.prototype.removeEventListeners=function(){if(this.thumbnail===null||this.thumbnail===undefined){return}this.thumbnail.removeEventListener("click",this.thumbClickProxy);this.thumbnail.removeEventListener("dragstart",this.onDragStartProxy)};Lotus.AbstractThumbnailView.prototype.onThumbClick=function(event){this.resetState()};Lotus.AbstractThumbnailView.prototype.onDragStart=function(event){};Lotus.AbstractThumbnailView.prototype.getImageURL=function(){return this.model.thumbUrl};Lotus.AbstractThumbnailView.prototype.getDefaultSize=function(){return{width:this.thumbnail.width,height:this.thumbnail.height}};Lotus.AbstractThumbnailView.prototype.getContainerSize=function(){var returnObj=this.thumbnailContainer!==null&&this.thumbnailContainer!==undefined?{width:parseInt(window.getComputedStyle(this.thumbnailContainer).width),height:parseInt(window.getComputedStyle(this.thumbnailContainer).height)}:{width:NaN,height:NaN};if(!isNaN(parseInt(this.thumbWidth))&&!isNaN(parseInt(this.thumbWidth))){returnObj={width:this.thumbWidth,height:this.thumbHeight}}return returnObj};Lotus.AbstractThumbnailView.prototype.defineSkinParts=function(){Lotus.AbstractItemView.prototype.defineSkinParts.call(this);this.skinParts.addItem(new Lotus.SkinPart("thumbnail",this,"thumbnail"));this.skinParts.addItem(new Lotus.SkinPart("thumbnailContainer",this,"thumbnailContainer"))};Lotus.AbstractThumbnailView.prototype.onSkinPartAdded=function(part,element){Lotus.AbstractItemView.prototype.onSkinPartAdded.call(this,part,element);switch(part){case"thumbnail":this.thumbnail.onLoad=function(event){this.sizeImage()}.bind(this);this.thumbnail.src=this.getImageURL();this.addEventListeners();break;case"thumbnailContainer":this.thumbnailSelectedClass=this.thumbnailContainer.getAttribute("selected-class");break}};Lotus.AbstractThumbnailView.prototype.onThumbClick=function(event){this.resetState()};Lotus.AbstractThumbnailView.prototype.resetState=function(){this.thumbnailContainer.classList.toggle(this.thumbnailSelectedClass);var eventType=this.thumbnailContainer.classList.contains(this.thumbnailSelectedClass)?Lotus.ItemViewEvent.ITEM_SELECTED:Lotus.ItemViewEvent.ITEM_DESELECTED;this.dispatch(new Lotus.ItemViewEvent(eventType,{item:this}))};Lotus.AbstractThumbnailView.prototype.destroy=function(){Lotus.AbstractItemView.prototype.destroy.call(this);this.removeEventListeners();this.thumbnail=null;this.thumbnailContainer=null;this.thumbnailSelectedClass=null;this.thumbClickProxy=null;this.onDragStartProxy=null};Lotus.Button=function(){var _buttonSkinPart;var _type;this.clickProxy=this.onClick.bind(this);this.addProperties({type:{get:function(){return _type},set:function(val){_type=val;this.Notify(val,"type")}},buttonSkinPart:{get:function(){return _buttonSkinPart},set:function(val){_buttonSkinPart=val;this.Notify(val,"buttonSkinPart")}}});Lotus.AbstractComponent.prototype.constructor.call(this)};Lavender.ObjectUtils.extend(Lotus.AbstractComponent,Lotus.Button);Lotus.Button.prototype.defineSkinParts=function(){this.skinParts.addItem(new Lotus.SkinPart("button",this,"buttonSkinPart"))};Lotus.Button.prototype.created=function(element,context){console.log("Lotus.Button.prototype.created");Lotus.AbstractComponent.prototype.created.call(this,element,context)};Lotus.Button.prototype.onSkinPartAdded=function(part,skinPart){switch(part){case"button":console.log("Lotus.Button.prototype.onSkinPartAdded: part: "+part);console.log("Lotus.Button.prototype.onSkinPartAdded: skinPart: "+skinPart);this.addEventListeners();break}};Lotus.Button.prototype.addEventListeners=function(){Lotus.AbstractComponent.prototype.addEventListeners.call(this);this.buttonSkinPart.addEventListener("click",this.clickProxy)};Lotus.Button.prototype.removeEventListeners=function(){Lotus.AbstractComponent.prototype.removeEventListeners.call(this);this.buttonSkinPart.removeEventListener("click",this.clickProxy)};Lotus.Button.prototype.onClick=function(event){console.log("Lotus.Button.prototype.onClick: event is "+event);console.log("Lotus.Button.prototype.onClick: my id is "+this.id);this.dispatch(new Lavender.AbstractEvent("click",{target:this.buttonSkinPart,originalEvent:event}))};
//# sourceMappingURL=/Users/dsmiley/workspace/lotusJS/minify/lotus.min.js.map